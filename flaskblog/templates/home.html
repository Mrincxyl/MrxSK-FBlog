{% extends "layout.html" %}
{% block content %}
  {% for post in posts.items %}
    <article class="media content-section shadow-sm p-3 mb-4 bg-white rounded">
      <img class="rounded-circle article-img border" 
           src="{{ url_for('static', filename='profile_pics/' + post.author.image_file) }}" 
           alt="{{ post.author.username }} profile picture" 
           style="width: 60px; height: 60px; object-fit: cover;">
      
      <div class="media-body ml-3">
        <div class="article-metadata mb-1">
          <a class="font-weight-bold text-dark mr-2" 
             href="{{ url_for('users.user_posts', username=post.author.username) }}">
             {{ post.author.username }}
          </a>
          <small class="text-muted">
            {{ post.date_posted.strftime('%b %d, %Y') }}
          </small>
        </div>

        <h3>
          <a class="article-title text-primary" 
             href="{{ url_for('posts.post', post_id=post.id) }}">
             {{ post.title }}
          </a>
        </h3>
        
        <p class="article-content text-secondary">
          {{ post.content[:200] }}{% if post.content|length > 200 %}...{% endif %}
        </p>

        <a class="btn btn-sm btn-outline-primary" 
           href="{{ url_for('posts.post', post_id=post.id) }}">
           Read More →
        </a>
      </div>
    </article>
  {% endfor %}

  <!-- Pagination -->
  <nav aria-label="Page navigation">
    <ul class="pagination justify-content-center">
      {% for page_num in posts.iter_pages(left_edge=1, right_edge=1, left_current=1, right_current=2) %}
        {% if page_num %}
          {% if posts.page == page_num %}
            <li class="page-item active">
              <a class="page-link" href="{{ url_for('main.home', page=page_num) }}">{{ page_num }}</a>
            </li>
          {% else %}
            <li class="page-item">
              <a class="page-link" href="{{ url_for('main.home', page=page_num) }}">{{ page_num }}</a>
            </li>
          {% endif %}
        {% else %}
          <li class="page-item disabled"><a class="page-link">…</a></li>
        {% endif %}
      {% endfor %}
    </ul>
  </nav>
{% endblock content %}
